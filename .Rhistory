asp=FALSE,
vertex.label.cex=0.6,
# edge.width=edgeweights,
edge.arrow.mode=0,
main="Survivors Event")
mtext(caption,outer=TRUE,cex=1.5)
dev.off()
}
network.plots<-function(nw.x1,nw.x2,caption,filename){
pdf(file=filename,width=15,height=8,pointsize=15)
par(mfrow=c(1,2),oma=c(0,0,2,0))
plot(
nw.x1,
layout=layout.fruchterman.reingold,
edge.curved=TRUE,
# vertex.size=vSizes,
vertex.label.dist=-0.5,
vertex.label.color="black",
asp=FALSE,
vertex.label.cex=0.6,
# edge.width=edgeweights,
edge.arrow.mode=0,
main="Survivors Admission")
plot(
nw.x2,
layout=layout.fruchterman.reingold,
edge.curved=TRUE,
# vertex.size=vSizes,
vertex.label.dist=-0.5,
vertex.label.color="black",
asp=FALSE,
vertex.label.cex=0.6,
# edge.width=edgeweights,
edge.arrow.mode=0,
main="Survivors Event")
mtext(caption,outer=TRUE,cex=1.5)
dev.off()
}
create.Igraphclustering <- function(A, methodlist, thresh = 0.05){
cm.x1 <- create.adjacency.matrix(A, methodlist, thresh)
# Make an Igraph object from this matrix:
g.x1<-graph.adjacency(cm.x1,weighted=TRUE, mode="undirected", diag=FALSE)
# Simplfy the adjacency object
g.x1<-simplify(g.x1, remove.multiple=TRUE, remove.loops=TRUE)
# Colour negative correlation edges as red
E(g.x1)[which(E(g.x1)$weight<0)]$color <- "red"
# Colour positive correlation edges as blue
E(g.x1)[which(E(g.x1)$weight>0)]$color <- "blue"
# Convert edge weights to absolute values
E(g.x1)$weight <- abs(E(g.x1)$weight)
# let's see if we have communities here using the
# Grivan-Newman algorithm
# 1st we calculate the edge betweenness, merges, etc...
g.communities.x1 <- edge.betweenness.community(g.x1, weights=NULL, directed=FALSE)
g.clustering.x1 <- make_clusters(g.x1, membership=g.communities.x1$membership)
V(g.x1)$color <- g.communities.x1$membership
list(g.clustering.x1, g.x1)
}
load("C:/Users/leoni/Desktop/LEONIE/DataExample.RData")
create.Igraphclustering(x1,list("Spearman"))
g1 <- create.Igraphclustering(x1,list("Spearman"))
g2 <- create.Igraphclustering(x2,list("Spearman"))
network.plots(g1[[2]],g2[[2]],"Spearman", "C:/Users/leoni/Desktop/LEONIE/NWPlots.pdf")
clust.plot <- function(x1, x2,poscol = "blue", negcol = "red", caption, filename){
g1 <- create.Igraphclustering(x1, list("Spearman"))
g2 <- create.Igraphclustering(x2, list("Spearman"))
E(g.x1)[which(E(g.x1)$weight<0)]$color <- negcol
E(g.x1)[which(E(g.x1)$weight>0)]$color <- poscol
pdf(file=filename,width=15,height=8,pointsize=15)
par(mfrow=c(1,2),oma=c(0,0,2,0))
plot(
g1[[1]], g1[[2]],
layout=layout.fruchterman.reingold,
edge.curved=TRUE,
# vertex.size=vSizes,
#vertex.label.dist=-0.5,
#vertex.label.color="red",
asp=1,
vertex.label.cex=0.6,
edge.width=E(nw.x1)$weight*4,
#edge.arrow.mode=0,
main="Survivors Admission")
plot(
g2[[1]], g2[[2]],
layout=layout.fruchterman.reingold,
edge.curved=TRUE,
# vertex.size=vSizes,
vertex.label.dist=-0.5,
vertex.label.color="black",
asp=FALSE,
vertex.label.cex=0.6,
# edge.width=edgeweights,
edge.arrow.mode=0,
main="Survivors Event")
mtext(caption,outer=TRUE,cex=1.5)
dev.off()
}
create.Igraphclustering(x1,list("Spearman"))
clust.plot(x1, x2, "Spearman", "C:/Users/leoni/Desktop/LEONIE/ClusPlots7.pdf")
clust.plot(x1, x2, caption = "Spearman", filename = "C:/Users/leoni/Desktop/LEONIE/ClusPlots7.pdf")
clust.plot <- function(x1, x2,poscol = "blue", negcol = "red", caption, filename){
g1 <- create.Igraphclustering(x1, list("Spearman"))
g2 <- create.Igraphclustering(x2, list("Spearman"))
E(g1[[2]])[which(E(g1[[2]])$weight<0)]$color <- negcol
E(g1[[2]])[which(E(g1[[2]])$weight>0)]$color <- poscol
E(g2[[2]])[which(E(g2[[2]])$weight<0)]$color <- negcol
E(g2[[2]])[which(E(g2[[2]])$weight>0)]$color <- poscol
pdf(file=filename,width=15,height=8,pointsize=15)
par(mfrow=c(1,2),oma=c(0,0,2,0))
plot(
g1[[1]], g1[[2]],
layout=layout.fruchterman.reingold,
edge.curved=TRUE,
# vertex.size=vSizes,
#vertex.label.dist=-0.5,
#vertex.label.color="red",
asp=1,
vertex.label.cex=0.6,
edge.width=E(nw.x1)$weight*4,
#edge.arrow.mode=0,
main="Survivors Admission")
plot(
g2[[1]], g2[[2]],
layout=layout.fruchterman.reingold,
edge.curved=TRUE,
# vertex.size=vSizes,
vertex.label.dist=-0.5,
vertex.label.color="black",
asp=FALSE,
vertex.label.cex=0.6,
# edge.width=edgeweights,
edge.arrow.mode=0,
main="Survivors Event")
mtext(caption,outer=TRUE,cex=1.5)
dev.off()
}
clust.plot(x1, x2, caption = "Spearman", filename = "C:/Users/leoni/Desktop/LEONIE/ClusPlots7.pdf")
clust.plot <- function(x1, x2,poscol = "blue", negcol = "red", caption, filename){
g1 <- create.Igraphclustering(x1, list("Spearman"))
g2 <- create.Igraphclustering(x2, list("Spearman"))
E(g1[[2]])[which(E(g1[[2]])$weight<0)]$color <- negcol
E(g1[[2]])[which(E(g1[[2]])$weight>0)]$color <- poscol
E(g2[[2]])[which(E(g2[[2]])$weight<0)]$color <- negcol
E(g2[[2]])[which(E(g2[[2]])$weight>0)]$color <- poscol
pdf(file=filename,width=15,height=8,pointsize=15)
par(mfrow=c(1,2),oma=c(0,0,2,0))
plot(
g1[[1]], g1[[2]],
layout=layout.fruchterman.reingold,
edge.curved=TRUE,
# vertex.size=vSizes,
#vertex.label.dist=-0.5,
#vertex.label.color="red",
asp=1,
vertex.label.cex=0.6,
edge.width=E(g1[[2]])$weight*4,
#edge.arrow.mode=0,
main="Survivors Admission")
plot(
g2[[1]], g2[[2]],
layout=layout.fruchterman.reingold,
edge.curved=TRUE,
# vertex.size=vSizes,
vertex.label.dist=-0.5,
vertex.label.color="black",
asp=FALSE,
vertex.label.cex=0.6,
# edge.width=edgeweights,
edge.arrow.mode=0,
main="Survivors Event")
mtext(caption,outer=TRUE,cex=1.5)
dev.off()
}
clust.plot(x1, x2, caption = "Spearman", filename = "C:/Users/leoni/Desktop/LEONIE/ClusPlots7.pdf")
g <- create.Igraphclustering(x1,list("Spearman"))
g[[2]]
v(g[[2]])
V(g[[2]])
V(g[[2]])$size
clust.plot <- function(x1, x2,poscol = "blue", negcol = "red", caption, layout, filename){
g1 <- create.Igraphclustering(x1, list("Spearman"))
g2 <- create.Igraphclustering(x2, list("Spearman"))
E(g1[[2]])[which(E(g1[[2]])$weight<0)]$color <- negcol
E(g1[[2]])[which(E(g1[[2]])$weight>0)]$color <- poscol
E(g2[[2]])[which(E(g2[[2]])$weight<0)]$color <- negcol
E(g2[[2]])[which(E(g2[[2]])$weight>0)]$color <- poscol
pdf(file=filename,width=15,height=8,pointsize=15)
par(mfrow=c(1,2),oma=c(0,0,2,0))
plot(
g1[[1]], g1[[2]],
layout=layout,
edge.curved=TRUE,
vertex.size=3,
#vertex.label.dist=-0.5,
#vertex.label.color="red",
#asp=1,
vertex.label.cex=0.6,
edge.width=E(g1[[2]])$weight*4,
#edge.arrow.mode=0,
main="Survivors Admission")
plot(
g2[[1]], g2[[2]],
layout=layout.fruchterman.reingold,
edge.curved=TRUE,
# vertex.size=vSizes,
vertex.label.dist=-0.5,
vertex.label.color="black",
asp=FALSE,
vertex.label.cex=0.6,
# edge.width=edgeweights,
edge.arrow.mode=0,
main="Survivors Event")
mtext(caption,outer=TRUE,cex=1.5)
dev.off()
}
clust.plot(x1, x2, caption = "Spearman",layout = layout.fruchterman.reingold, filename = "C:/Users/leoni/Desktop/LEONIE/ClusPlots7.pdf")
clust.plot <- function(x1, x2,poscol = "blue", negcol = "red", caption, layout, filename){
g1 <- create.Igraphclustering(x1, list("Spearman"))
g2 <- create.Igraphclustering(x2, list("Spearman"))
E(g1[[2]])[which(E(g1[[2]])$weight<0)]$color <- negcol
E(g1[[2]])[which(E(g1[[2]])$weight>0)]$color <- poscol
E(g2[[2]])[which(E(g2[[2]])$weight<0)]$color <- negcol
E(g2[[2]])[which(E(g2[[2]])$weight>0)]$color <- poscol
pdf(file=filename,width=15,height=8,pointsize=15)
par(mfrow=c(1,2),oma=c(0,0,2,0))
plot(
g1[[1]], g1[[2]],
layout=layout,
edge.curved=TRUE,
vertex.size=15,
#vertex.label.dist=-0.5,
#vertex.label.color="red",
#asp=1,
vertex.label.cex=0.6,
edge.width=E(g1[[2]])$weight*4,
#edge.arrow.mode=0,
main="Survivors Admission")
plot(
g2[[1]], g2[[2]],
layout=layout.fruchterman.reingold,
edge.curved=TRUE,
# vertex.size=vSizes,
vertex.label.dist=-0.5,
vertex.label.color="black",
asp=FALSE,
vertex.label.cex=0.6,
# edge.width=edgeweights,
edge.arrow.mode=0,
main="Survivors Event")
mtext(caption,outer=TRUE,cex=1.5)
dev.off()
}
clust.plot(x1, x2, caption = "Spearman",layout = layout.fruchterman.reingold, filename = "C:/Users/leoni/Desktop/LEONIE/ClusPlots7.pdf")
clust.plot <- function(x1, x2,poscol = "blue", negcol = "red", caption, layout, filename){
g1 <- create.Igraphclustering(x1, list("Spearman"))
g2 <- create.Igraphclustering(x2, list("Spearman"))
E(g1[[2]])[which(E(g1[[2]])$weight<0)]$color <- negcol
E(g1[[2]])[which(E(g1[[2]])$weight>0)]$color <- poscol
E(g2[[2]])[which(E(g2[[2]])$weight<0)]$color <- negcol
E(g2[[2]])[which(E(g2[[2]])$weight>0)]$color <- poscol
pdf(file=filename,width=15,height=8)#,pointsize=15)
par(mfrow=c(1,2),oma=c(0,0,2,0))
plot(
g1[[1]], g1[[2]],
layout=layout,
edge.curved=TRUE,
vertex.size=15,
#vertex.label.dist=-0.5,
#vertex.label.color="red",
#asp=1,
vertex.label.cex=0.6,
edge.width=E(g1[[2]])$weight*4,
#edge.arrow.mode=0,
main="Survivors Admission")
plot(
g2[[1]], g2[[2]],
layout=layout.fruchterman.reingold,
edge.curved=TRUE,
# vertex.size=vSizes,
vertex.label.dist=-0.5,
vertex.label.color="black",
asp=FALSE,
vertex.label.cex=0.6,
# edge.width=edgeweights,
edge.arrow.mode=0,
main="Survivors Event")
mtext(caption,outer=TRUE,cex=1.5)
dev.off()
}
clust.plot(x1, x2, caption = "Spearman",layout = layout.fruchterman.reingold, filename = "C:/Users/leoni/Desktop/LEONIE/ClusPlots7.pdf")
clust.plot <- function(x1, x2,poscol = "blue", negcol = "red", caption, layout, vSize, tSize, filename){
g1 <- create.Igraphclustering(x1, list("Spearman"))
g2 <- create.Igraphclustering(x2, list("Spearman"))
E(g1[[2]])[which(E(g1[[2]])$weight<0)]$color <- negcol
E(g1[[2]])[which(E(g1[[2]])$weight>0)]$color <- poscol
E(g2[[2]])[which(E(g2[[2]])$weight<0)]$color <- negcol
E(g2[[2]])[which(E(g2[[2]])$weight>0)]$color <- poscol
pdf(file=filename,width=15,height=8)#,pointsize=15)
par(mfrow=c(1,2),oma=c(0,0,2,0))
plot(
g1[[1]], g1[[2]],
layout=layout,
edge.curved=TRUE,
vertex.size=vSize,
#vertex.label.dist=-0.5,
#vertex.label.color="red",
#asp=1,
vertex.label.cex=tSize,
edge.width=E(g1[[2]])$weight*4,
#edge.arrow.mode=0,
main="Survivors Admission")
plot(
g2[[1]], g2[[2]],
layout=layout,
edge.curved=TRUE,
vertex.size=vSize,
#vertex.label.dist=-0.5,
#vertex.label.color="black",
#asp=FALSE,
vertex.label.cex=tSize,
edge.width=E(g2[[2]])$weight*4,
#edge.arrow.mode=0,
main="Survivors Event")
mtext(caption,outer=TRUE,cex=1.5)
dev.off()
}
clust.plot(x1, x2, caption = "Spearman",layout = layout.fruchterman.reingold, filename = "C:/Users/leoni/Desktop/LEONIE/ClusPlots7.pdf")
clust.plot <- function(x1, x2,poscol = "blue", negcol = "red", caption, layout = layout.fruchterman.reingold, vSize = 15, tSize = 0.6, filename){
g1 <- create.Igraphclustering(x1, list("Spearman"))
g2 <- create.Igraphclustering(x2, list("Spearman"))
E(g1[[2]])[which(E(g1[[2]])$weight<0)]$color <- negcol
E(g1[[2]])[which(E(g1[[2]])$weight>0)]$color <- poscol
E(g2[[2]])[which(E(g2[[2]])$weight<0)]$color <- negcol
E(g2[[2]])[which(E(g2[[2]])$weight>0)]$color <- poscol
pdf(file=filename,width=15,height=8)#,pointsize=15)
par(mfrow=c(1,2),oma=c(0,0,2,0))
plot(
g1[[1]], g1[[2]],
layout=layout,
edge.curved=TRUE,
vertex.size=vSize,
#vertex.label.dist=-0.5,
#vertex.label.color="red",
#asp=1,
vertex.label.cex=tSize,
edge.width=E(g1[[2]])$weight*4,
#edge.arrow.mode=0,
main="Survivors Admission")
plot(
g2[[1]], g2[[2]],
layout=layout,
edge.curved=TRUE,
vertex.size=vSize,
#vertex.label.dist=-0.5,
#vertex.label.color="black",
#asp=FALSE,
vertex.label.cex=tSize,
edge.width=E(g2[[2]])$weight*4,
#edge.arrow.mode=0,
main="Survivors Event")
mtext(caption,outer=TRUE,cex=1.5)
dev.off()
}
clust.plot(x1, x2, caption = "Spearman",layout = layout.fruchterman.reingold, filename = "C:/Users/leoni/Desktop/LEONIE/ClusPlots7.pdf")
clust.plot <- function(x1, x2,poscol = "blue", negcol = "red", caption, layout = layout.fruchterman.reingold, vSize = 15, tSize = 0.8, filename){
g1 <- create.Igraphclustering(x1, list("Spearman"))
g2 <- create.Igraphclustering(x2, list("Spearman"))
E(g1[[2]])[which(E(g1[[2]])$weight<0)]$color <- negcol
E(g1[[2]])[which(E(g1[[2]])$weight>0)]$color <- poscol
E(g2[[2]])[which(E(g2[[2]])$weight<0)]$color <- negcol
E(g2[[2]])[which(E(g2[[2]])$weight>0)]$color <- poscol
pdf(file=filename,width=15,height=8)#,pointsize=15)
par(mfrow=c(1,2),oma=c(0,0,2,0))
plot(
g1[[1]], g1[[2]],
layout=layout,
edge.curved=TRUE,
vertex.size=vSize,
#vertex.label.dist=-0.5,
#vertex.label.color="red",
#asp=1,
vertex.label.cex=tSize,
edge.width=E(g1[[2]])$weight*4,
#edge.arrow.mode=0,
main="Survivors Admission")
plot(
g2[[1]], g2[[2]],
layout=layout,
edge.curved=TRUE,
vertex.size=vSize,
#vertex.label.dist=-0.5,
#vertex.label.color="black",
#asp=FALSE,
vertex.label.cex=tSize,
edge.width=E(g2[[2]])$weight*4,
#edge.arrow.mode=0,
main="Survivors Event")
mtext(caption,outer=TRUE,cex=1.5)
dev.off()
}
clust.plot(x1, x2, caption = "Spearman",layout = layout.fruchterman.reingold, filename = "C:/Users/leoni/Desktop/LEONIE/ClusPlots7.pdf")
clust.plot <- function(x1, x2,poscol = "blue", negcol = "red", caption, layout = layout.fruchterman.reingold, vSize = 15, tSize = 0.8, filename){
g1 <- create.Igraphclustering(x1, list("Spearman"))
g2 <- create.Igraphclustering(x2, list("Spearman"))
E(g1[[2]])[which(E(g1[[2]])$weight<0)]$color <- negcol
E(g1[[2]])[which(E(g1[[2]])$weight>0)]$color <- poscol
E(g2[[2]])[which(E(g2[[2]])$weight<0)]$color <- negcol
E(g2[[2]])[which(E(g2[[2]])$weight>0)]$color <- poscol
pdf(file=filename,width=15,height=8)#,pointsize=15)
par(mfrow=c(1,2),oma=c(0,0,2,0))
plot(
g1[[1]], g1[[2]],
layout=layout,
edge.curved=TRUE,
vertex.size=vSize,
#vertex.label.dist=-0.5,
#vertex.label.color="red",
#asp=1,
vertex.label.cex=tSize,
edge.width=E(g1[[2]])$weight*4,
edge.arrow.mode=TRUE,
main="Survivors Admission")
plot(
g2[[1]], g2[[2]],
layout=layout,
edge.curved=TRUE,
vertex.size=vSize,
#vertex.label.dist=-0.5,
#vertex.label.color="black",
#asp=FALSE,
vertex.label.cex=tSize,
edge.width=E(g2[[2]])$weight*4,
#edge.arrow.mode=0,
main="Survivors Event")
mtext(caption,outer=TRUE,cex=1.5)
dev.off()
}
clust.plot(x1, x2, caption = "Spearman",layout = layout.fruchterman.reingold, filename = "C:/Users/leoni/Desktop/LEONIE/ClusPlots7.pdf")
clust.plot <- function(x1, x2,poscol = "blue", negcol = "red", caption, layout = layout.fruchterman.reingold, vSize = 15, tSize = 0.8, filename){
g1 <- create.Igraphclustering(x1, list("Spearman"))
g2 <- create.Igraphclustering(x2, list("Spearman"))
E(g1[[2]])[which(E(g1[[2]])$weight<0)]$color <- negcol
E(g1[[2]])[which(E(g1[[2]])$weight>0)]$color <- poscol
E(g2[[2]])[which(E(g2[[2]])$weight<0)]$color <- negcol
E(g2[[2]])[which(E(g2[[2]])$weight>0)]$color <- poscol
pdf(file=filename,width=15,height=8)#,pointsize=15)
par(mfrow=c(1,2),oma=c(0,0,2,0))
plot(
g1[[1]], g1[[2]],
layout=layout,
edge.curved=TRUE,
vertex.size=vSize,
#vertex.label.dist=-0.5,
#vertex.label.color="red",
#asp=1,
vertex.label.cex=tSize,
edge.width=E(g1[[2]])$weight*4,
edge.arrow.mode=0.6,
main="Survivors Admission")
plot(
g2[[1]], g2[[2]],
layout=layout,
edge.curved=TRUE,
vertex.size=vSize,
#vertex.label.dist=-0.5,
#vertex.label.color="black",
#asp=FALSE,
vertex.label.cex=tSize,
edge.width=E(g2[[2]])$weight*4,
#edge.arrow.mode=0,
main="Survivors Event")
mtext(caption,outer=TRUE,cex=1.5)
dev.off()
}
clust.plot(x1, x2, caption = "Spearman",layout = layout.fruchterman.reingold, filename = "C:/Users/leoni/Desktop/LEONIE/ClusPlots7.pdf")
clust.plot <- function(x1, x2,poscol = "blue", negcol = "red", caption, layout = layout.fruchterman.reingold, vSize = 15, tSize = 0.8, filename){
g1 <- create.Igraphclustering(x1, list("Spearman"))
g2 <- create.Igraphclustering(x2, list("Spearman"))
E(g1[[2]])[which(E(g1[[2]])$weight<0)]$color <- negcol
E(g1[[2]])[which(E(g1[[2]])$weight>0)]$color <- poscol
E(g2[[2]])[which(E(g2[[2]])$weight<0)]$color <- negcol
E(g2[[2]])[which(E(g2[[2]])$weight>0)]$color <- poscol
pdf(file=filename,width=15,height=8)#,pointsize=15)
par(mfrow=c(1,2),oma=c(0,0,2,0))
plot(
g1[[1]], g1[[2]],
layout=layout,
edge.curved=TRUE,
vertex.size=vSize,
#vertex.label.dist=-0.5,
#vertex.label.color="red",
#asp=1,
vertex.label.cex=tSize,
edge.width=E(g1[[2]])$weight*4,
edge.arrow.mode=FALSE,
main="Survivors Admission")
plot(
g2[[1]], g2[[2]],
layout=layout,
edge.curved=TRUE,
vertex.size=vSize,
#vertex.label.dist=-0.5,
#vertex.label.color="black",
#asp=FALSE,
vertex.label.cex=tSize,
edge.width=E(g2[[2]])$weight*4,
edge.arrow.mode=FALSE,
main="Survivors Event")
mtext(caption,outer=TRUE,cex=1.5)
dev.off()
}
clust.plot(x1, x2, caption = "Spearman",layout = layout.fruchterman.reingold, filename = "C:/Users/leoni/Desktop/LEONIE/ClusPlots7.pdf")
